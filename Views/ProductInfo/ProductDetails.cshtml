@{
    ViewBag.Title = "ProductDetails";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .io-hidden {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 0.8s ease, transform 0.8s ease;
        will-change: opacity, transform;
    }

    .io-show {
        opacity: 1;
        transform: translateY(0);
    }

    .io-image {
        transform: scale(0.96);
    }

        .io-image.io-show {
            transform: scale(1);
        }

    .feature-text {
        font-size: 1.05rem;
        line-height: 1.7;
        color: #6c757d;
        max-width: 520px;
    }

    .product-thumb {
        border: 2px solid #afafaf;
        border-radius: 8px;
        transition: border-color 0.25s ease, box-shadow 0.25s ease;
    }

    .active-thumb {
        border-color: #2fb380;
        box-shadow: 0 0 0 2px rgba(25, 135, 84, 0.75);
    }
</style>

<div class="container mt-3">

    <!-- PRODUCT HEADER -->
    <div class="row g-5 align-items-start">

        <div class="col-12 col-md-6">
            <img id="mainProductImage"
                 src="@Model.ImageURL"
                 class="img-fluid rounded w-100 mb-3"
                 style="max-height:380px; object-fit:contain;" />

            <div class="d-flex justify-content-center gap-2">
                <img src="@Model.ImageURL"
                     class="img-thumbnail product-thumb active-thumb"
                     style="width:90px;height:90px;object-fit:contain;cursor:pointer;"
                     onclick="changeImage(this)" />

                <img src="@Model.ImageURL3"
                     class="img-thumbnail product-thumb"
                     style="width:90px;height:90px;object-fit:contain;cursor:pointer;"
                     onclick="changeImage(this)" />

                <img src="@Model.ImageURL2"
                     class="img-thumbnail product-thumb"
                     style="width:90px;height:90px;object-fit:contain;cursor:pointer;"
                     onclick="changeImage(this)" />
            </div>
        </div>

        <div class="col-12 col-md-6">
            <h1 class="fw-bold">@Model.ProductName</h1>
            <h3 class="text-success">₹ @Model.Price</h3>

            <p>
                <strong>Availability:</strong>
                <span class="badge @(Model.Stock > 0 ? "bg-success" : "bg-danger")">
                    @(Model.Stock > 0 ? "In Stock" : "Out of Stock")
                </span>
            </p>

            <hr />

            <h5 class="fw-bold mt-4">About this product</h5>
            <p class="text-muted">@Model.Description</p>

            <div class="d-flex gap-3 mt-4">
                <button class="btn btn-success" @(Model.Stock <= 0 ? "disabled" : "")>
                    Add to Cart
                </button>
                <a href="@Url.Action("Products","Home")" class="btn btn-outline-secondary">
                    Back
                </a>
            </div>
        </div>
    </div>

    <!-- FEATURE 1 -->
    <div class="row align-items-center mt-5 io-hidden">

        <div class="col-12 col-md-7 order-2 order-md-1">
            <p class="feature-text mt-3">
                @Model.FeatureDescription
            </p>
        </div>

        <div class="col-12 col-md-5 order-1 order-md-2 text-center">
            <img src="@Model.FeatureImageURL"
                 class="img-fluid rounded w-100 io-hidden io-image"
                 style="max-height:360px;object-fit:contain;" />
        </div>
    </div>

    <!-- FEATURE 2 -->
    <div class="row align-items-center mt-5 io-hidden">

        <div class="col-12 col-md-5 order-2 order-md-2">
            <p class="feature-text mt-3">
                @Model.FeatureDescription2
            </p>
        </div>

        <div class="col-12 col-md-7 order-1 order-md-1 text-center">
            <img src="@Model.FeatureImageURL2"
                 class="img-fluid rounded w-100 io-hidden io-image"
                 style="max-height:360px;object-fit:contain;" />
        </div>
    </div>

    <!-- FEATURE 3 -->
    <div class="row align-items-center mt-5 io-hidden">

        <div class="col-12 col-md-7 order-2 order-md-1">
            <p class="feature-text mt-3">
                @Model.FeatureDescription3
            </p>
        </div>

        <div class="col-12 col-md-5 order-1 order-md-2 text-center">
            <img src="@Model.FeatureImageURL3"
                 class="img-fluid rounded w-100 io-hidden io-image"
                 style="max-height:360px;object-fit:contain;" />
        </div>
    </div>

    <!-- FEATURE 4 -->
    <div class="row align-items-center mt-5 io-hidden">

        <div class="col-12 col-md-5 order-2 order-md-2">
            <p class="feature-text mt-3">
                @Model.FeatureDescription4
            </p>
        </div>

        <div class="col-12 col-md-7 order-1 order-md-1 text-center">
            <img src="@Model.FeatureImageURL4"
                 class="img-fluid rounded w-100 io-hidden io-image"
                 style="max-height:360px;object-fit:contain;" />
        </div>
    </div>

</div>

<script>
    function changeImage(thumb) {
        document.getElementById("mainProductImage").src = thumb.src;
        document.querySelectorAll(".product-thumb")
            .forEach(t => t.classList.remove("active-thumb"));
        thumb.classList.add("active-thumb");
    }

    document.addEventListener("DOMContentLoaded", () => {
        const observer = new IntersectionObserver(entries => {
            entries.forEach(e => {
                e.target.classList.toggle("io-show", e.isIntersecting);
            });
        }, { threshold: 0.25 });

        document.querySelectorAll(".io-hidden").forEach(el => observer.observe(el));
    });
</script>
